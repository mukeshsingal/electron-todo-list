<!DOCTYPE html>
<html lang="en">

<head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
    <title>To Do List</title>
    <style>
        #title-bar {
            -webkit-app-region: drag;
        }

        #title-bar-btns {
            -webkit-app-region: no-drag;
            position: fixed;
            top: 0px;
            right: 6px;
        }
    </style>
</head>

<body>
    <script>
        (function () {
            // Retrieve remote BrowserWindow
            const { BrowserWindow } = require('electron').remote

            function init() {
                // Minimize task
                document.getElementById("min-btn").addEventListener("click", (e) => {
                    var window = BrowserWindow.getFocusedWindow();
                    window.minimize();
                });

                // Maximize window
                document.getElementById("max-btn").addEventListener("click", (e) => {
                    var window = BrowserWindow.getFocusedWindow();
                    if (window.isMaximized()) {
                        window.unmaximize();
                    } else {
                        window.maximize();
                    }
                });

                // Close app
                document.getElementById("close-btn").addEventListener("click", (e) => {
                    var window = BrowserWindow.getFocusedWindow();
                    window.close();
                });
            };

            document.onreadystatechange = () => {
                if (document.readyState == "complete") {
                    init();
                }
            };
        })();
    </script>
    <nav style="line-height:46px; height: 46px;">
        <div id="title-bar" class="row" style="background-color: TEAL; font-size: 20px">
            <div class="col s6">
                <b>
                    <a>Bucket List</a>
                </b>
            </div>
            <div class="col s6">
                <div id="title-bar-btns" class="right-align" style="margin-right: 20px">
                    <button id="min-btn" class="btn-floating grey" style="width:15px; height:15px"></button>
                    <button id="max-btn" class="btn-floating orange" style="width:15px; height:15px" ></button>
                    <button id="close-btn" class="btn-floating red" style="width:15px; height:15px" ></button>
                </div>
            </div>
        </div>
    </nav>
    <ul></ul>
</body>


<script>
    const electron = require('electron');
    const { ipcRenderer } = electron;
    const ul = document.querySelector('ul');
    const colors = [ 'CRIMSON', 'RED', 'FIREBRICK', 'DARKRED', 'DEEPPINK', 'MEDIUMVIOLETRED', 'PALEVIOLETRED', 'TOMATO', 'ORANGERED', 'DARKORANGE', 'ORANGE', 'GOLD', 'DARKKHAKI', 'VIOLET', 'ORCHID', 'FUCHSIA', 'MAGENTA', 'MEDIUMORCHID', 'MEDIUMPURPLE', 'REBECCAPURPLE', 'BLUEVIOLET', 'DARKVIOLET', 'DARKORCHID', 'DARKMAGENTA', 'PURPLE', 'INDIGO', 'SLATEBLUE', 'DARKSLATEBLUE', 'MEDIUMSLATEBLUE', 'GREENYELLOW', 'CHARTREUSE', 'LAWNGREEN', 'LIME', 'LIMEGREEN', 'SPRINGGREEN', 'MEDIUMSEAGREEN', 'SEAGREEN', 'FORESTGREEN', 'GREEN', 'DARKGREEN', 'YELLOWGREEN', 'OLIVEDRAB', 'OLIVE', 'DARKOLIVEGREEN', 'MEDIUMAQUAMARINE', 'DARKSEAGREEN', 'LIGHTSEAGREEN', 'DARKCYAN', 'TEAL', 'DARKTURQUOISE', 'CADETBLUE', 'STEELBLUE', 'MEDIUMSLATEBLUE', 'ROYALBLUE', 'BLUE', 'MEDIUMBLUE', 'DARKBLUE', 'NAVY', 'MIDNIGHTBLUE', 'SADDLEBROWN', 'SIENNA', 'BROWN', 'MAROON', 'GRAY', 'DIMGRAY', 'LIGHTSLATEGRAY', 'SLATEGRAY', 'DARKSLATEGRAY']
    
    //catch add item
    ipcRenderer.on('item:add', function (e, item) {
        const li = document.createElement('li');
        const div = document.createElement('div');
        
        div.classList.add('valign-wrapper', 'circle');
        div.style.cssText = 'color: white; width: 30px; height:30px;justify-content: center;display: inline-flex;margin-right: 20px;';
        div.style.backgroundColor = colors[getRandomInt(0,67)];
        div.textContent = ul.children.length + 1;
        
        li.style.fontSize = '14px';
        li.style.backgroundColor = 'transparent';
        li.className = 'collection-item';
        li.appendChild(div);
        li.appendChild(document.createTextNode(item));

        ul.appendChild(li);
        ul.className = 'collection';
    })

    //catch clear all element 
    ipcRenderer.on('item:clear', function () {
        ul.innerHTML = '';
        ul.className = '';
    })

    //remove elements
    ul.addEventListener('dblclick', removeItem);
    function removeItem(e) {
        e.target.remove();
        if (ul.children.length == 0) {
            ul.className = '';
        }
        updateToDoItemIndexes();    
    }

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function updateToDoItemIndexes(){

        const ul = document.querySelector('ul');
        for (var i = 0; i < ul.childNodes.length; i++){
            var curChild = ul.childNodes[i];
            curChild.firstChild.textContent = i+1;
        }
    }
</script>

</html>